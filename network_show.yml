---
- name: "Get Junos OS configuration in set format"
  hosts: mytest
  gather_facts: no
  collections:
    - juniper.junos

  tasks:
    - name: "Get selected configuration hierarchies and save to file"
      juniper.junos.junos_command:
        commands:
          - "show lldp neighbors"
          - "show interfaces terse"
          - "show chassis environment"
          - "show chassis hardware"
          - "show version"
          - "show system alarms"
          - "show chassis alarms"
          - "show bgp summary"
          - "show chassis fpc"
          - "show cli history"
        format: text
      register: junos_output

    - name: "Write output to file"
      copy:
        content: "{{ junos_output.stdout | join('\n\n') }}"
        dest: "/tmp/{{ inventory_hostname }}-{{ lookup('pipe','date +%Y-%m-%d') }}.txt"
